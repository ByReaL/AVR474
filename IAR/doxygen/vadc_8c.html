<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="atmel-header_files/filelist.xml">
<link rel=Edit-Time-Data href="atmel-header_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>@DOC_TITLE@</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>ping.zhou</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>ping.zhou</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2010-08-04T02:58:00Z</o:Created>
  <o:LastSaved>2010-08-04T02:58:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>51</o:Words>
  <o:Characters>297</o:Characters>
  <o:Company>Atmel</o:Company>
  <o:Lines>2</o:Lines>
  <o:Paragraphs>1</o:Paragraphs>
  <o:CharactersWithSpaces>347</o:CharactersWithSpaces>
  <o:Version>11.9999</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>150</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<link rel=Stylesheet type="text/css" media=all href="doxygen.css">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536902279 -2147483648 8 0 511 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<table class=MsoNormalTable border=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt;background:white'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><a href="http://www.atmel.com"><span style='text-decoration:none;
  text-underline:none'><img border=0 width=109 height=50 id="_x0000_i1025"
  src=atmel.jpg></span></a></p>
  <p class=MsoNormal><o:p>&nbsp;</o:p></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><strong><span style='font-size:24.0pt;
  font-family:Helvetica;color:black'>SmartBattery</span></strong></span><strong><span
  style='font-size:24.0pt;font-family:Helvetica;color:black'> Device
  Application Note</span></strong></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p><a href="http://www.atmel.com/products/AVR"><span style='text-decoration:
  none;text-underline:none'><img border=0 width=138 height=77 id="_x0000_i1026"
  src="AVR_logo_blue.gif"></span></a></p>
  <p class=MsoNormal><o:p>&nbsp;</o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes;height:.75pt'>
  <td colspan=3 style='padding:.75pt .75pt .75pt .75pt;height:.75pt'
  background=blue.gif>
  <p class=MsoNormal><span style='font-size:1.0pt;mso-bidi-font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_21d9b7b08462661958c4d98529a1490d.html">lib_board</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a5fb918b7b8b7bbe476e8ee237ea5319.html">v_adc</a>
  </div>
</div>
<div class="contents">
<h1>vadc.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Routines for VADC measurements. 
<p>
This file contains all functions used for sapmling VADC inputs, that is Cells, normal vadc iputs that can be used for thermistor measurements, and lastly the internal temperature reference.<p>
<dl class="user" compact><dt><b>Application note:</b></dt><dd>AVR474: SB202 Firmware user's guide.</dd></dl>
<dl class="user" compact><dt><b>Documentation</b></dt><dd>For comprehensive code documentation, supported compilers, compiler settings and supported devices see readme.html</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Atmel Corporation: <a href="http://www.atmel.com">http://www.atmel.com</a> <br>
 Support email: <a href="mailto:avr@atmel.com">avr@atmel.com</a></dd></dl>
<dl class="rcs" compact><dt><b>Revision</b></dt><dd>6090 </dd></dl>
<dl class="rcs" compact><dt><b>Date</b></dt><dd>2009-10-05 21:40:12 +0800 (Mon, 05 Oct 2009) </dd></dl>
<br>
<p>
Copyright (c) 2009, Atmel Corporation All rights reserved.<p>
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:<p>
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.<p>
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.<p>
3. The name of ATMEL may not be used to endorse or promote products derived from this software without specific prior written permission.<p>
THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
<p>Definition in file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>
<code>#include &quot;<a class="el" href="common_8h-source.html">common.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="ATmega32HVB__signature_8h-source.html">ATmega32HVB_signature.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="vadc_8h-source.html">vadc.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for vadc.c:</div>
<div class="dynsection">
<p><center><img src="vadc_8c__incl.gif" border="0" usemap="#lib_board/v_adc/vadc.c_map" alt=""></center>
<map name="lib_board/v_adc/vadc.c_map">
<area shape="rect" href="common_8h.html" title="Common headerfile." alt="" coords="273,304,356,331"><area shape="rect" href="ATmega32HVB__signature_8h.html" title="Signature row defines for ATmega16HVB and ATmega32HVB." alt="" coords="17,155,199,181"><area shape="rect" href="vadc_8h.html" title="Headerfile for vadc_usage.c." alt="" coords="293,80,352,107"><area shape="rect" href="stdint_8h.html" title="stdint.h" alt="" coords="409,379,473,405"><area shape="rect" href="error_8h.html" title="error.h" alt="" coords="244,379,303,405"><area shape="rect" href="battery__pack__parameters_8h.html" title="Definition file for a smart battery pack." alt="" coords="379,155,557,181"><area shape="rect" href="sbs__commands_8h.html" title="Headerfile for sbs_commands.c." alt="" coords="253,229,376,256"><area shape="rect" href="battery__protection_8h.html" title="Header file for Battery Protection peripheral module driver." alt="" coords="400,229,536,256"><area shape="rect" href="battery__current__monitoring_8h.html" title="Header file for CC&#45;ADC result processing firmware module." alt="" coords="560,229,747,256"><area shape="rect" href="crc16_8h.html" title="Header file for CRC16 functions." alt="" coords="503,304,567,331"></map>
</div>

<p>
<a href="vadc_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698">err_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#c2fd0c6752a999af5d7b98ccbfb082f6">DUVR_DisableCheck</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if DUVR mode can be disabled and if so disable it.  <a href="#c2fd0c6752a999af5d7b98ccbfb082f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#e5465bb86b1978fdcdd6b962e050f373">VADC_Cell1VoltageReady</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if new cell1 voltage readings are available.  <a href="#e5465bb86b1978fdcdd6b962e050f373"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#ae4676ebbd808e1908f8163a9972aa2a">VADC_CellTempReady</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if new cell temperature readings are available.  <a href="#ae4676ebbd808e1908f8163a9972aa2a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#2394682eaa80101d85ce5d023beeaf5d">VADC_ClearReadyFlags</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clear the ready flags.  <a href="#2394682eaa80101d85ce5d023beeaf5d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#17b52dc8ba1c8c63103ef4cee9a9fdc0">VADC_GetScanConfig</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current ScanConfig.  <a href="#17b52dc8ba1c8c63103ef4cee9a9fdc0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#baaa20b9d383080b1f434dbaa5999e12">VADC_InitializeVadcCoefficients</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if new cell2 voltage readings are available.  <a href="#baaa20b9d383080b1f434dbaa5999e12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">__interrupt void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#e09008d7d72d205a8464354f571fe14c">VADC_ISR</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interrupt Service Function to measure VADC values.  <a href="#e09008d7d72d205a8464354f571fe14c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#dc8b0995e310a115bb72c23830abdf49">VADC_readCellVoltage</a> (<a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a> cellIndex)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculation of cell voltage.  <a href="#dc8b0995e310a115bb72c23830abdf49"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#ae4c822ab63bf82a578b0489e1b52129">VADC_readSystemTemperature</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculation of chip temperature.  <a href="#ae4c822ab63bf82a578b0489e1b52129"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#d643e5b97a0eb9cd93ae80e2527bbade">VADC_ScanConfig</a> (<a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a> CellInputs, <a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a> VadcInputs, <a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a> vtempScan)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Select VADC channels to be scanned.  <a href="#d643e5b97a0eb9cd93ae80e2527bbade"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="vadc_8h.html#837efbd444e46d60a46b9762d7fb01c8">vadcState_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#a36cbd40622b622424c4d6af8fb2bef3">VADC_ScanState</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check VADC scan status.  <a href="#a36cbd40622b622424c4d6af8fb2bef3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698">err_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#ed438796e781f411ac4cfbd3a89b2429">VADC_StartScan</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start a scan of all VADC channels.  <a href="#ed438796e781f411ac4cfbd3a89b2429"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#0b978ff704a91cd39fc99bd6dbe2031d">VADC_VTempReady</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if new core temperature reading s available.  <a href="#0b978ff704a91cd39fc99bd6dbe2031d"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f">cellGain</a> [BATTPARAM_CELLS_IN_SERIES]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gain coefficients for Cells.  <a href="#15539802be0709baff2a07339f42ce6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#581662a132acab8e3ce549d018874d03">cellMeasurement</a> [BATTPARAM_CELLS_IN_SERIES]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cell input samples from the vadc ISR.  <a href="#581662a132acab8e3ce549d018874d03"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#ef44329758059c91c76d334e8fc09700">int8_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd">cellOffset</a> [BATTPARAM_CELLS_IN_SERIES]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Offset for cells.  <a href="#db97aeed8bd0d11fb210e1ae86f65bbd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#c829a83ff99a490b333ec98302419850">cellVoltage</a> [BATTPARAM_CELLS_IN_SERIES]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.  <a href="#c829a83ff99a490b333ec98302419850"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79">vadcScanConfig</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">VADC channel sampling config.  <a href="#658c51041b7ceacab85ac70e4216ca79"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct <a class="el" href="structVADC__Status.html">VADC_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#8a6c3694b1912cc4077876b658cab7db">vptatCoeff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal temperature sensor coefficient.  <a href="#8a6c3694b1912cc4077876b658cab7db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vadc_8c.html#07c6f60b9c283becc2c047613b3a934d">vtempMeasurement</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">VTEMP input sample from the vadc ISR.  <a href="#07c6f60b9c283becc2c047613b3a934d"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c2fd0c6752a999af5d7b98ccbfb082f6"></a><!-- doxytag: member="vadc.c::DUVR_DisableCheck" ref="c2fd0c6752a999af5d7b98ccbfb082f6" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698">err_t</a> DUVR_DisableCheck           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check if DUVR mode can be disabled and if so disable it. 
<p>
If the voltage on the cells are sufficiently high after a reset the Deep Under-Voltage Recovery (DUVR) mode should be disabled and possibly the Charge FET (CFET) enabled. This function assumes a VADC scan has been performed and uses the cell samples to calculate cell voltages.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698c7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a> or <a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698a5571864412c8275a2e18a931fddcaa6">FAILURE</a> </dd></dl>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00560">560</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00089">CELL1</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL2</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL3</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL4</a>, <a class="el" href="error_8h-source.html#l00005">FAILURE</a>, <a class="el" href="error_8h-source.html#l00005">SUCCESS</a>, <a class="el" href="vadc_8c-source.html#l00450">VADC_readCellVoltage()</a>, and <a class="el" href="vadc_8h-source.html#l00100">VB_DUVR_DFET</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l01033">disableDUVRIfPossible()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00561"></a>00561 {
<a name="l00562"></a>00562     <span class="keywordtype">bool</span> disableDuvr;
<a name="l00563"></a>00563     <span class="keywordtype">bool</span> enableDischargeFet;
<a name="l00564"></a>00564     <a class="code" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> temp_cell;
<a name="l00565"></a>00565     
<a name="l00566"></a>00566     temp_cell = <a class="code" href="vadc_8c.html#dc8b0995e310a115bb72c23830abdf49" title="Calculation of cell voltage.">VADC_readCellVoltage</a>(<a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>);
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="keywordflow">if</span> ( temp_cell &gt; battParams.cellDuvrDisableVoltage ) {
<a name="l00569"></a>00569         disableDuvr = <span class="keyword">true</span>;
<a name="l00570"></a>00570         <span class="comment">//FCSR |= (1 &lt;&lt; CFE) | (1 &lt;&lt; DUVRD);</span>
<a name="l00571"></a>00571         <span class="keywordflow">if</span> ( temp_cell &gt; (battParams.cellDuvrDisableVoltage + <a class="code" href="vadc_8h.html#867cb482516537c5017d1bdc210c527e" title="Voltage across DFET diode.">VB_DUVR_DFET</a>) ) {
<a name="l00572"></a>00572             enableDischargeFet = <span class="keyword">true</span>;
<a name="l00573"></a>00573         } <span class="keywordflow">else</span> {
<a name="l00574"></a>00574             enableDischargeFet = <span class="keyword">false</span>;
<a name="l00575"></a>00575         }
<a name="l00576"></a>00576     } <span class="keywordflow">else</span> {
<a name="l00577"></a>00577         disableDuvr = <span class="keyword">false</span>;
<a name="l00578"></a>00578     }
<a name="l00579"></a>00579     
<a name="l00580"></a>00580     <span class="comment">// If cell1 was above duvr disable limits, check if cell2 is</span>
<a name="l00581"></a>00581 <span class="preprocessor"># if BATTPARAM_CELLS_IN_SERIES &gt;= 2</span>
<a name="l00582"></a>00582 <span class="preprocessor"></span>    temp_cell = <a class="code" href="vadc_8c.html#dc8b0995e310a115bb72c23830abdf49" title="Calculation of cell voltage.">VADC_readCellVoltage</a>(<a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a>);
<a name="l00583"></a>00583     <span class="keywordflow">if</span>( disableDuvr ) {
<a name="l00584"></a>00584         <span class="keywordflow">if</span> ( temp_cell &lt;= battParams.cellDuvrDisableVoltage ) {
<a name="l00585"></a>00585             disableDuvr = <span class="keyword">false</span>;
<a name="l00586"></a>00586         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(enableDischargeFet) {
<a name="l00587"></a>00587             <span class="keywordflow">if</span> ( temp_cell &lt;= (battParams.cellDuvrDisableVoltage + <a class="code" href="vadc_8h.html#867cb482516537c5017d1bdc210c527e" title="Voltage across DFET diode.">VB_DUVR_DFET</a>) ) {
<a name="l00588"></a>00588                 enableDischargeFet = <span class="keyword">false</span>;
<a name="l00589"></a>00589             }
<a name="l00590"></a>00590         }
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 <span class="preprocessor"># endif</span>
<a name="l00593"></a>00593 <span class="preprocessor"></span>
<a name="l00594"></a>00594 <span class="preprocessor"># if BATTPARAM_CELLS_IN_SERIES &gt;= 3</span>
<a name="l00595"></a>00595 <span class="preprocessor"></span>    temp_cell = <a class="code" href="vadc_8c.html#dc8b0995e310a115bb72c23830abdf49" title="Calculation of cell voltage.">VADC_readCellVoltage</a>(<a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a>);
<a name="l00596"></a>00596     <span class="keywordflow">if</span>( disableDuvr ) {
<a name="l00597"></a>00597         <span class="keywordflow">if</span> ( temp_cell &lt;= battParams.cellDuvrDisableVoltage ) {
<a name="l00598"></a>00598             disableDuvr = <span class="keyword">false</span>;
<a name="l00599"></a>00599         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(enableDischargeFet) {
<a name="l00600"></a>00600             <span class="keywordflow">if</span> ( temp_cell &lt;= (battParams.cellDuvrDisableVoltage + <a class="code" href="vadc_8h.html#867cb482516537c5017d1bdc210c527e" title="Voltage across DFET diode.">VB_DUVR_DFET</a>) ) {
<a name="l00601"></a>00601                 enableDischargeFet = <span class="keyword">false</span>;
<a name="l00602"></a>00602             }
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 <span class="preprocessor"># endif</span>
<a name="l00606"></a>00606 <span class="preprocessor"></span>
<a name="l00607"></a>00607 <span class="preprocessor"># if BATTPARAM_CELLS_IN_SERIES &gt;= 4</span>
<a name="l00608"></a>00608 <span class="preprocessor"></span>    temp_cell = <a class="code" href="vadc_8c.html#dc8b0995e310a115bb72c23830abdf49" title="Calculation of cell voltage.">VADC_readCellVoltage</a>(<a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714495dc31be69defc09d627e487ce6a56c1a">CELL4</a>);
<a name="l00609"></a>00609     <span class="keywordflow">if</span>( disableDuvr ) {
<a name="l00610"></a>00610         <span class="keywordflow">if</span> ( temp_cell &lt;= battParams.cellDuvrDisableVoltage ) {
<a name="l00611"></a>00611             disableDuvr = <span class="keyword">false</span>;
<a name="l00612"></a>00612         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(enableDischargeFet) {
<a name="l00613"></a>00613             <span class="keywordflow">if</span> ( temp_cell &lt;= (battParams.cellDuvrDisableVoltage + <a class="code" href="vadc_8h.html#867cb482516537c5017d1bdc210c527e" title="Voltage across DFET diode.">VB_DUVR_DFET</a>) ) {
<a name="l00614"></a>00614                 enableDischargeFet = <span class="keyword">false</span>;
<a name="l00615"></a>00615             }
<a name="l00616"></a>00616         }
<a name="l00617"></a>00617     }
<a name="l00618"></a>00618 <span class="preprocessor"># endif</span>
<a name="l00619"></a>00619 <span class="preprocessor"></span>    
<a name="l00620"></a>00620     <span class="keywordflow">if</span>( disableDuvr ) {
<a name="l00621"></a>00621         <span class="keywordflow">if</span>( enableDischargeFet ) {
<a name="l00622"></a>00622             FCSR = (1&lt;&lt;CFE) | (1&lt;&lt;DFE) | (1&lt;&lt;DUVRD);
<a name="l00623"></a>00623         } <span class="keywordflow">else</span> {
<a name="l00624"></a>00624             FCSR = (1&lt;&lt;CFE) | (1&lt;&lt;DUVRD);
<a name="l00625"></a>00625         }
<a name="l00626"></a>00626         <span class="keywordflow">return</span> <a class="code" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698c7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;
<a name="l00627"></a>00627     } <span class="keywordflow">else</span> {
<a name="l00628"></a>00628         <span class="keywordflow">return</span> <a class="code" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698a5571864412c8275a2e18a931fddcaa6">FAILURE</a>;
<a name="l00629"></a>00629     }
<a name="l00630"></a>00630 }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="vadc_8c_c2fd0c6752a999af5d7b98ccbfb082f6_cgraph.gif" border="0" usemap="#vadc_8c_c2fd0c6752a999af5d7b98ccbfb082f6_cgraph_map" alt=""></center>
<map name="vadc_8c_c2fd0c6752a999af5d7b98ccbfb082f6_cgraph_map">
<area shape="rect" href="vadc_8c.html#dc8b0995e310a115bb72c23830abdf49" title="Calculation of cell voltage." alt="" coords="199,5,353,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="e5465bb86b1978fdcdd6b962e050f373"></a><!-- doxytag: member="vadc.c::VADC_Cell1VoltageReady" ref="e5465bb86b1978fdcdd6b962e050f373" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VADC_Cell1VoltageReady           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if new cell1 voltage readings are available. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00339">339</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00079">VADC_Status::cell1VoltageReady</a>, and <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00340"></a>00340 {
<a name="l00341"></a>00341     <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> interruptState = __save_interrupt();
<a name="l00342"></a>00342     __disable_interrupt();
<a name="l00343"></a>00343     
<a name="l00344"></a>00344     <span class="keywordtype">bool</span> flagState = <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#756e168b84e1b4dde5699954ba84b310">cell1VoltageReady</a>;
<a name="l00345"></a>00345     
<a name="l00346"></a>00346     __restore_interrupt( interruptState );
<a name="l00347"></a>00347     
<a name="l00348"></a>00348     <span class="keywordflow">return</span> flagState;
<a name="l00349"></a>00349 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ae4676ebbd808e1908f8163a9972aa2a"></a><!-- doxytag: member="vadc.c::VADC_CellTempReady" ref="ae4676ebbd808e1908f8163a9972aa2a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VADC_CellTempReady           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if new cell temperature readings are available. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00313">313</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00084">VADC_Status::cellTempReady</a>, and <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00314"></a>00314 {
<a name="l00315"></a>00315     <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> interruptState = __save_interrupt();
<a name="l00316"></a>00316     __disable_interrupt();
<a name="l00317"></a>00317     
<a name="l00318"></a>00318     <span class="keywordtype">bool</span> flagState = <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#0e45bd70893d5b5247be1324aa03f2a1">cellTempReady</a>;
<a name="l00319"></a>00319     
<a name="l00320"></a>00320     __restore_interrupt( interruptState );
<a name="l00321"></a>00321     
<a name="l00322"></a>00322     <span class="keywordflow">return</span> flagState;
<a name="l00323"></a>00323 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2394682eaa80101d85ce5d023beeaf5d"></a><!-- doxytag: member="vadc.c::VADC_ClearReadyFlags" ref="2394682eaa80101d85ce5d023beeaf5d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VADC_ClearReadyFlags           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear the ready flags. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00150">150</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00079">VADC_Status::cell1VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00080">VADC_Status::cell2VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00081">VADC_Status::cell3VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00082">VADC_Status::cell4VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00084">VADC_Status::cellTempReady</a>, <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>, and <a class="el" href="vadc_8h-source.html#l00083">VADC_Status::vtempReady</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00187">main()</a>, and <a class="el" href="vadc_8c-source.html#l00175">VADC_StartScan()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00151"></a>00151 {
<a name="l00152"></a>00152 <span class="preprocessor">#if CELL_INPUTS &gt;= 4</span>
<a name="l00153"></a>00153 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#d53c1328c92007356d48a274a8d9312d">cell4VoltageReady</a> = <span class="keyword">false</span>;
<a name="l00154"></a>00154 <span class="preprocessor">#endif</span>
<a name="l00155"></a>00155 <span class="preprocessor"></span><span class="preprocessor">#if CELL_INPUTS &gt;= 3</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#15683309f1e6c669523d80d70a1d360e">cell3VoltageReady</a> = <span class="keyword">false</span>;
<a name="l00157"></a>00157 <span class="preprocessor">#endif</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span><span class="preprocessor">#if CELL_INPUTS &gt;= 2</span>
<a name="l00159"></a>00159 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#d495ca8b75139a910bd9e1e47462687b">cell2VoltageReady</a> = <span class="keyword">false</span>;
<a name="l00160"></a>00160 <span class="preprocessor">#endif</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#756e168b84e1b4dde5699954ba84b310">cell1VoltageReady</a> = <span class="keyword">false</span>;
<a name="l00162"></a>00162     <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#0e45bd70893d5b5247be1324aa03f2a1">cellTempReady</a> = <span class="keyword">false</span>;
<a name="l00163"></a>00163     <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#8422bc7922ffdd16e97595cd643a8149">vtempReady</a> = <span class="keyword">false</span>;
<a name="l00164"></a>00164 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="17b52dc8ba1c8c63103ef4cee9a9fdc0"></a><!-- doxytag: member="vadc.c::VADC_GetScanConfig" ref="17b52dc8ba1c8c63103ef4cee9a9fdc0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> VADC_GetScanConfig           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the current ScanConfig. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00144">144</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8c-source.html#l00090">vadcScanConfig</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00144"></a>00144                              {
<a name="l00145"></a>00145     <span class="keywordflow">return</span> <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a>;
<a name="l00146"></a>00146 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="baaa20b9d383080b1f434dbaa5999e12"></a><!-- doxytag: member="vadc.c::VADC_InitializeVadcCoefficients" ref="baaa20b9d383080b1f434dbaa5999e12" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VADC_InitializeVadcCoefficients           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if new cell2 voltage readings are available. 
<p>
Return true if new cell3 voltage readings are available<p>
Return true if new cell4 voltage readings are available<p>
Initialization of variables for cell voltage, adc voltage and vtemp calculations. The coefficients are stored in (file) global variables. Interrupts are disabled and re-enabled if needed afterwards. 
<p>Definition at line <a class="el" href="vadc_8c-source.html#l00405">405</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8c-source.html#l00061">cellGain</a>, <a class="el" href="vadc_8c-source.html#l00062">cellOffset</a>, <a class="el" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE()</a>, <a class="el" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD()</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00095">SIG_VADC_ADC0_GAIN_L</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00099">SIG_VADC_ADC0_OFFSET</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00097">SIG_VADC_ADC1_GAIN_L</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00100">SIG_VADC_ADC1_OFFSET</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00083">SIG_VADC_CELL1_GAIN_L</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00091">SIG_VADC_CELL1_OFFSET</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00085">SIG_VADC_CELL2_GAIN_L</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00092">SIG_VADC_CELL2_OFFSET</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00087">SIG_VADC_CELL3_GAIN_L</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00093">SIG_VADC_CELL3_OFFSET</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00089">SIG_VADC_CELL4_GAIN_L</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00094">SIG_VADC_CELL4_OFFSET</a>, <a class="el" href="ATmega32HVB__signature_8h-source.html#l00081">SIG_VPTAT_L</a>, and <a class="el" href="vadc_8c-source.html#l00072">vptatCoeff</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00406"></a>00406 {   
<a name="l00407"></a>00407     <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> interrupt_status = __save_interrupt();  <span class="comment">// Disable interrupts.</span>
<a name="l00408"></a>00408     __disable_interrupt();
<a name="l00409"></a>00409     
<a name="l00410"></a>00410     <a class="code" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f" title="Gain coefficients for Cells.">cellGain</a>[0] = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#fe4d8829e6256cc539a7d35e453d8814">SIG_VADC_CELL1_GAIN_L</a>);
<a name="l00411"></a>00411     <a class="code" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd" title="Offset for cells.">cellOffset</a>[0] = <a class="code" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE</a>(<a class="code" href="ATmega32HVB__signature_8h.html#0cbb0d5e9dca5967f1935a5126e9c1b5">SIG_VADC_CELL1_OFFSET</a>);
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="preprocessor">#if CELL_INPUTS &gt;= 2</span>
<a name="l00414"></a>00414 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f" title="Gain coefficients for Cells.">cellGain</a>[1] = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#599bcb1df7bafe8e61acbcb3171f4b6e">SIG_VADC_CELL2_GAIN_L</a>);
<a name="l00415"></a>00415     <a class="code" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd" title="Offset for cells.">cellOffset</a>[1] = <a class="code" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE</a>(<a class="code" href="ATmega32HVB__signature_8h.html#ec3f73fdac92efae72aa48a5c150b07b">SIG_VADC_CELL2_OFFSET</a>);
<a name="l00416"></a>00416 <span class="preprocessor">#endif</span>
<a name="l00417"></a>00417 <span class="preprocessor"></span>    
<a name="l00418"></a>00418 <span class="preprocessor">#if CELL_INPUTS &gt;= 3</span>
<a name="l00419"></a>00419 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f" title="Gain coefficients for Cells.">cellGain</a>[2] = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#d6bd8d787342bbea884da1149c872d22">SIG_VADC_CELL3_GAIN_L</a>);
<a name="l00420"></a>00420     <a class="code" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd" title="Offset for cells.">cellOffset</a>[2] = <a class="code" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE</a>(<a class="code" href="ATmega32HVB__signature_8h.html#f4a30ce844591aaf004c24a0174f6ded">SIG_VADC_CELL3_OFFSET</a>);
<a name="l00421"></a>00421 <span class="preprocessor">#endif</span>
<a name="l00422"></a>00422 <span class="preprocessor"></span>    
<a name="l00423"></a>00423 <span class="preprocessor">#if CELL_INPUTS &gt;= 4</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span>    <a class="code" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f" title="Gain coefficients for Cells.">cellGain</a>[3] = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#36ff3d436ef799388dc692ab4ae21eb4">SIG_VADC_CELL4_GAIN_L</a>);
<a name="l00425"></a>00425     <a class="code" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd" title="Offset for cells.">cellOffset</a>[3] = <a class="code" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE</a>(<a class="code" href="ATmega32HVB__signature_8h.html#e4151a7a3f29559aacca65d41321d07a">SIG_VADC_CELL4_OFFSET</a>);
<a name="l00426"></a>00426 <span class="preprocessor">#endif</span>
<a name="l00427"></a>00427 <span class="preprocessor"></span>
<a name="l00428"></a>00428     <a class="code" href="vadc_8c.html#8a6c3694b1912cc4077876b658cab7db" title="Internal temperature sensor coefficient.">vptatCoeff</a> = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#f3e675da87817058b9f6d0fe9841094b">SIG_VPTAT_L</a>);
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="preprocessor">#if VADC_INPUTS &gt;= 1</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>    vadcGain[0] = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#f3f9ba5712180bd5be6099120535f3c1">SIG_VADC_ADC0_GAIN_L</a>);
<a name="l00432"></a>00432     vadcOffset[0] = <a class="code" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE</a>(<a class="code" href="ATmega32HVB__signature_8h.html#8c2f2d5cdb047a01edd7970fd45f5ba4">SIG_VADC_ADC0_OFFSET</a>);
<a name="l00433"></a>00433 <span class="preprocessor">#endif</span>
<a name="l00434"></a>00434 <span class="preprocessor"></span>    
<a name="l00435"></a>00435 <span class="preprocessor">#if VADC_INPUTS &gt;= 2</span>
<a name="l00436"></a>00436 <span class="preprocessor"></span>    vadcGain[1] = <a class="code" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741">READ_SIGNATUREWORD</a>(<a class="code" href="ATmega32HVB__signature_8h.html#45780f7d4bda1b2ae7b88d837f69ab38">SIG_VADC_ADC1_GAIN_L</a>);
<a name="l00437"></a>00437     vadcOffset[1] = <a class="code" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e">READ_SIGNATUREBYTE</a>(<a class="code" href="ATmega32HVB__signature_8h.html#d7de122080235d26ad11d873416565b1">SIG_VADC_ADC1_OFFSET</a>);
<a name="l00438"></a>00438 <span class="preprocessor">#endif</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span>    
<a name="l00440"></a>00440     __restore_interrupt(interrupt_status);
<a name="l00441"></a>00441 }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="vadc_8c_baaa20b9d383080b1f434dbaa5999e12_cgraph.gif" border="0" usemap="#vadc_8c_baaa20b9d383080b1f434dbaa5999e12_cgraph_map" alt=""></center>
<map name="vadc_8c_baaa20b9d383080b1f434dbaa5999e12_cgraph_map">
<area shape="rect" href="common_8h.html#8dec381e6ff65f996cc9b817e6939d6e" title="READ_SIGNATUREBYTE" alt="" coords="267,5,437,32"><area shape="rect" href="common_8h.html#a16b708c9ea40f05cacc9d2e4456f741" title="READ_SIGNATUREWORD" alt="" coords="263,56,441,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="e09008d7d72d205a8464354f571fe14c"></a><!-- doxytag: member="vadc.c::VADC_ISR" ref="e09008d7d72d205a8464354f571fe14c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__interrupt void VADC_ISR           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Interrupt Service Function to measure VADC values. 
<p>
This ISR scans all vadc channels selected by vadcScanConfig and then disables itself. It continues from the input selected in <a class="el" href="vadc_8c.html#ed438796e781f411ac4cfbd3a89b2429" title="Start a scan of all VADC channels.">VADC_StartScan()</a>. The order is fixed; VTEMP, ADC0, ADC1, CELL1 and CELL2 last. Measurements are stored in global variables vtempMeasurement, vadcMeasurement and cellMeasurement. Cells are measured last to give the possiblity to disable cell balancing (if applicable). 
<p>Definition at line <a class="el" href="vadc_8c-source.html#l00210">210</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00089">CELL1</a>, <a class="el" href="vadc_8h-source.html#l00079">VADC_Status::cell1VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL2</a>, <a class="el" href="vadc_8h-source.html#l00080">VADC_Status::cell2VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL3</a>, <a class="el" href="vadc_8h-source.html#l00081">VADC_Status::cell3VoltageReady</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL4</a>, <a class="el" href="vadc_8h-source.html#l00082">VADC_Status::cell4VoltageReady</a>, <a class="el" href="vadc_8c-source.html#l00063">cellMeasurement</a>, <a class="el" href="vadc_8h-source.html#l00084">VADC_Status::cellTempReady</a>, <a class="el" href="vadc_8c-source.html#l00064">cellVoltage</a>, <a class="el" href="vadc_8h-source.html#l00078">VADC_Status::state</a>, <a class="el" href="vadc_8h-source.html#l00089">VADC0</a>, <a class="el" href="vadc_8h-source.html#l00089">VADC1</a>, <a class="el" href="vadc_8h-source.html#l00075">VADC_NOT_RUNNING</a>, <a class="el" href="vadc_8h-source.html#l00075">VADC_RUNNING</a>, <a class="el" href="vadc_8h-source.html#l00075">VADC_SCAN_FAILED</a>, <a class="el" href="vadc_8c-source.html#l00090">vadcScanConfig</a>, <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>, <a class="el" href="vadc_8h-source.html#l00089">VTEMP</a>, <a class="el" href="vadc_8c-source.html#l00073">vtempMeasurement</a>, and <a class="el" href="vadc_8h-source.html#l00083">VADC_Status::vtempReady</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> state;
<a name="l00213"></a>00213     
<a name="l00214"></a>00214     state = VADMUX;
<a name="l00215"></a>00215     
<a name="l00216"></a>00216     <span class="keywordflow">switch</span> (state) {
<a name="l00217"></a>00217     <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714499726d93b81232e1e9a84c16e5355e77b">VTEMP</a> :
<a name="l00218"></a>00218         <a class="code" href="vadc_8c.html#07c6f60b9c283becc2c047613b3a934d" title="VTEMP input sample from the vadc ISR.">vtempMeasurement</a> = VADC;
<a name="l00219"></a>00219         <span class="keywordflow">if</span> (<a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>) ) {
<a name="l00220"></a>00220             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>;
<a name="l00221"></a>00221         } <span class="keywordflow">else</span> {
<a name="l00222"></a>00222             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>;
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#8422bc7922ffdd16e97595cd643a8149">vtempReady</a> = <span class="keyword">true</span>;
<a name="l00225"></a>00225         <span class="keywordflow">break</span>;
<a name="l00226"></a>00226 <span class="preprocessor">#if VADC_INPUTS != 0</span>
<a name="l00227"></a>00227 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a> :
<a name="l00228"></a>00228         vadcMeasurement[0] = VADC;
<a name="l00229"></a>00229         <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144934a20579d8ecc17304f9c59844e33fd4">VADC1</a>) ) {
<a name="l00230"></a>00230             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144934a20579d8ecc17304f9c59844e33fd4">VADC1</a>;
<a name="l00231"></a>00231         } <span class="keywordflow">else</span> {
<a name="l00232"></a>00232             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>;
<a name="l00233"></a>00233             <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#0e45bd70893d5b5247be1324aa03f2a1">cellTempReady</a> = <span class="keyword">true</span>;
<a name="l00234"></a>00234         }
<a name="l00235"></a>00235         <span class="keywordflow">break</span>;
<a name="l00236"></a>00236 <span class="preprocessor">  #if VADC_INPUTS &gt;= 2</span>
<a name="l00237"></a>00237 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144934a20579d8ecc17304f9c59844e33fd4">VADC1</a> :
<a name="l00238"></a>00238         vadcMeasurement[1] = VADC;
<a name="l00239"></a>00239         VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>;
<a name="l00240"></a>00240         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#0e45bd70893d5b5247be1324aa03f2a1">cellTempReady</a> = <span class="keyword">true</span>;
<a name="l00241"></a>00241         <span class="keywordflow">break</span>;
<a name="l00242"></a>00242 <span class="preprocessor">  #endif // VADC_INPUTS &gt;= 2</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span><span class="preprocessor">#endif // VADC_INPUTS != 0</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a> :
<a name="l00245"></a>00245         <a class="code" href="vadc_8c.html#581662a132acab8e3ce549d018874d03" title="Cell input samples from the vadc ISR.">cellMeasurement</a>[0] = VADC;
<a name="l00246"></a>00246         <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[0] = 0xFFFF;
<a name="l00247"></a>00247         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#756e168b84e1b4dde5699954ba84b310">cell1VoltageReady</a> = <span class="keyword">true</span>;
<a name="l00248"></a>00248         <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a>) ) {
<a name="l00249"></a>00249             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a>;
<a name="l00250"></a>00250         } <span class="keywordflow">else</span> {
<a name="l00251"></a>00251             <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> = <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e9bd05128673fa3841b2a9b38f6a4115b">VADC_NOT_RUNNING</a>;
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253         <span class="keywordflow">break</span>;
<a name="l00254"></a>00254 <span class="preprocessor">#if CELL_INPUTS &gt;= 2</span>
<a name="l00255"></a>00255 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a> :
<a name="l00256"></a>00256         <a class="code" href="vadc_8c.html#581662a132acab8e3ce549d018874d03" title="Cell input samples from the vadc ISR.">cellMeasurement</a>[1] = VADC;
<a name="l00257"></a>00257         <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[1] = 0xFFFF;
<a name="l00258"></a>00258         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#d495ca8b75139a910bd9e1e47462687b">cell2VoltageReady</a> = <span class="keyword">true</span>;
<a name="l00259"></a>00259         <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a>) ) {
<a name="l00260"></a>00260             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a>;
<a name="l00261"></a>00261         } <span class="keywordflow">else</span> {
<a name="l00262"></a>00262             <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> = <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e9bd05128673fa3841b2a9b38f6a4115b">VADC_NOT_RUNNING</a>;
<a name="l00263"></a>00263         }
<a name="l00264"></a>00264         <span class="keywordflow">break</span>;
<a name="l00265"></a>00265 <span class="preprocessor">#endif // CELL_INPUTS &gt;= 2</span>
<a name="l00266"></a>00266 <span class="preprocessor"></span><span class="preprocessor">#if CELL_INPUTS &gt;= 3</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a> :
<a name="l00268"></a>00268         <a class="code" href="vadc_8c.html#581662a132acab8e3ce549d018874d03" title="Cell input samples from the vadc ISR.">cellMeasurement</a>[2] = VADC;
<a name="l00269"></a>00269         <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[2] = 0xFFFF;
<a name="l00270"></a>00270         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#15683309f1e6c669523d80d70a1d360e">cell3VoltageReady</a> = <span class="keyword">true</span>;
<a name="l00271"></a>00271         <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714495dc31be69defc09d627e487ce6a56c1a">CELL4</a>) ) {
<a name="l00272"></a>00272             VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714495dc31be69defc09d627e487ce6a56c1a">CELL4</a>;
<a name="l00273"></a>00273         } <span class="keywordflow">else</span> {
<a name="l00274"></a>00274             <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> = <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e9bd05128673fa3841b2a9b38f6a4115b">VADC_NOT_RUNNING</a>;
<a name="l00275"></a>00275         }
<a name="l00276"></a>00276         <span class="keywordflow">break</span>;
<a name="l00277"></a>00277 <span class="preprocessor">#endif // CELL_INPUTS &gt;= 3</span>
<a name="l00278"></a>00278 <span class="preprocessor"></span><span class="preprocessor">#if CELL_INPUTS &gt;= 4</span>
<a name="l00279"></a>00279 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714495dc31be69defc09d627e487ce6a56c1a">CELL4</a> :
<a name="l00280"></a>00280         <a class="code" href="vadc_8c.html#581662a132acab8e3ce549d018874d03" title="Cell input samples from the vadc ISR.">cellMeasurement</a>[3] = VADC;
<a name="l00281"></a>00281         <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[3] = 0xFFFF;
<a name="l00282"></a>00282         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#d53c1328c92007356d48a274a8d9312d">cell4VoltageReady</a> = <span class="keyword">true</span>;
<a name="l00283"></a>00283         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> = <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e9bd05128673fa3841b2a9b38f6a4115b">VADC_NOT_RUNNING</a>;
<a name="l00284"></a>00284         <span class="keywordflow">break</span>;
<a name="l00285"></a>00285 <span class="preprocessor">#endif // CELL_INPUTS &gt;= 4</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span>
<a name="l00287"></a>00287 
<a name="l00288"></a>00288         <span class="keywordflow">default</span>:
<a name="l00289"></a>00289         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> = <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e3e41ffa866ed5188b8772b68dd095294">VADC_SCAN_FAILED</a>;
<a name="l00290"></a>00290         <span class="keywordflow">break</span>;
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292     
<a name="l00293"></a>00293     <span class="keywordflow">if</span> (<a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> == <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e5fc0704fc5cb466b1d72ce9c2a2b5548">VADC_RUNNING</a>) {
<a name="l00294"></a>00294         VADCSR |= (1 &lt;&lt; VADSC);         <span class="comment">// Start next conversion now.</span>
<a name="l00295"></a>00295     } <span class="keywordflow">else</span> {
<a name="l00296"></a>00296         VADCSR &amp;= ~(1 &lt;&lt; VADEN);        <span class="comment">// Disable VADC (until next scan).</span>
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dc8b0995e310a115bb72c23830abdf49"></a><!-- doxytag: member="vadc.c::VADC_readCellVoltage" ref="dc8b0995e310a115bb72c23830abdf49" args="(vadcIndex_t cellIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> VADC_readCellVoltage           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a>&nbsp;</td>
          <td class="paramname"> <em>cellIndex</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculation of cell voltage. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cellIndex</em>&nbsp;</td><td>Which cell to calculate voltage for. The <a class="el" href="vadc_8c.html#581662a132acab8e3ce549d018874d03" title="Cell input samples from the vadc ISR.">cellMeasurement</a> array is used as source. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Voltage for selected cell index [mV] or zero if not valid. </dd></dl>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00450">450</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00089">CELL1</a>, <a class="el" href="vadc_8h-source.html#l00069">CELL_INPUTS</a>, <a class="el" href="vadc_8c-source.html#l00061">cellGain</a>, <a class="el" href="vadc_8c-source.html#l00063">cellMeasurement</a>, <a class="el" href="vadc_8c-source.html#l00062">cellOffset</a>, <a class="el" href="vadc_8c-source.html#l00064">cellVoltage</a>, and <a class="el" href="vadc_8h-source.html#l00061">VADC_SCALE_BITS</a>.</p>

<p>Referenced by <a class="el" href="battery__voltage__monitoring_8c-source.html#l00092">BATTVMON_IsCellVoltageTooHigh()</a>, <a class="el" href="battery__voltage__monitoring_8c-source.html#l00070">BATTVMON_IsCellVoltageTooLow()</a>, <a class="el" href="vadc_8c-source.html#l00560">DUVR_DisableCheck()</a>, <a class="el" href="gas__gauging_8c-source.html#l00131">GASG_AtRateOK()</a>, <a class="el" href="main_8c-source.html#l00904">handleNewCCADCResult()</a>, <a class="el" href="main_8c-source.html#l00812">handleNewCellVoltage()</a>, <a class="el" href="main_8c-source.html#l01076">handleSBSCommand()</a>, <a class="el" href="smbus__removed_8c-source.html#l00517">SMBR_Voltage()</a>, <a class="el" href="voltage__based__SoC_8c-source.html#l00238">VBSoC_EstimatedSoC()</a>, <a class="el" href="voltage__based__SoC_8c-source.html#l00108">VBSoC_Init()</a>, and <a class="el" href="voltage__based__SoC_8c-source.html#l00151">VBSoC_Update()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00451"></a>00451 {
<a name="l00452"></a>00452     <a class="code" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> calc;
<a name="l00453"></a>00453     
<a name="l00454"></a>00454     cellIndex -= <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (cellIndex &lt; <a class="code" href="vadc_8h.html#88c42c5b0177daab92b3c0c2ee164c4e" title="Number of adc Cell inputs. Defines size of many variables, so must be 2 if.">CELL_INPUTS</a>) {
<a name="l00457"></a>00457         <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> interruptState = __save_interrupt();
<a name="l00458"></a>00458         __disable_interrupt();
<a name="l00459"></a>00459         
<a name="l00460"></a>00460         <span class="comment">// If cellVoltage is invalid, get the measurement so we can calculate the cell voltage</span>
<a name="l00461"></a>00461         <span class="comment">// If it's valid, return it as quick as possible</span>
<a name="l00462"></a>00462         <span class="comment">// TODO: a bit ugly with the double __restore_interrupt, but i couldn't figure out a simplier (fast) way</span>
<a name="l00463"></a>00463         <span class="keywordflow">if</span> (0xFFFF == <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[cellIndex] ) {
<a name="l00464"></a>00464             calc = <a class="code" href="vadc_8c.html#581662a132acab8e3ce549d018874d03" title="Cell input samples from the vadc ISR.">cellMeasurement</a>[cellIndex];
<a name="l00465"></a>00465         } <span class="keywordflow">else</span> {
<a name="l00466"></a>00466             __restore_interrupt(interruptState);
<a name="l00467"></a>00467             <span class="keywordflow">return</span> <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[cellIndex];
<a name="l00468"></a>00468         }
<a name="l00469"></a>00469         __restore_interrupt(interruptState);
<a name="l00470"></a>00470         
<a name="l00471"></a>00471         <span class="comment">// Don't allow negative values</span>
<a name="l00472"></a>00472         <span class="keywordflow">if</span>(calc &lt; <a class="code" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd" title="Offset for cells.">cellOffset</a>[cellIndex]) {
<a name="l00473"></a>00473             calc = 0;
<a name="l00474"></a>00474         } <span class="keywordflow">else</span> {
<a name="l00475"></a>00475             calc -= <a class="code" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd" title="Offset for cells.">cellOffset</a>[cellIndex];
<a name="l00476"></a>00476             calc *= <a class="code" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f" title="Gain coefficients for Cells.">cellGain</a>[cellIndex];
<a name="l00477"></a>00477             calc &gt;&gt;= <a class="code" href="vadc_8h.html#daea25c71e5980d34dfacd562e290a7f" title="Number of bit for scaling results (16384). See VADC in datasheets for formulas.">VADC_SCALE_BITS</a>;
<a name="l00478"></a>00478         }
<a name="l00479"></a>00479         <a class="code" href="vadc_8c.html#c829a83ff99a490b333ec98302419850" title="Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement.">cellVoltage</a>[cellIndex] = (<a class="code" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>)calc;
<a name="l00480"></a>00480     } <span class="keywordflow">else</span> {
<a name="l00481"></a>00481         calc = 0;
<a name="l00482"></a>00482     }
<a name="l00483"></a>00483     
<a name="l00484"></a>00484     <span class="keywordflow">return</span> (<a class="code" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>)calc;
<a name="l00485"></a>00485 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ae4c822ab63bf82a578b0489e1b52129"></a><!-- doxytag: member="vadc.c::VADC_readSystemTemperature" ref="ae4c822ab63bf82a578b0489e1b52129" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> VADC_readSystemTemperature           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculation of chip temperature. 
<p>
The <a class="el" href="vadc_8c.html#07c6f60b9c283becc2c047613b3a934d" title="VTEMP input sample from the vadc ISR.">vtempMeasurement</a> variable sampled from the internal temperature sensor is used to calculate the chip temperature.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Temperature in 0.1 kelvin [K]. </dd></dl>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00535">535</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00061">VADC_SCALE_BITS</a>, <a class="el" href="vadc_8c-source.html#l00072">vptatCoeff</a>, and <a class="el" href="vadc_8c-source.html#l00073">vtempMeasurement</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00683">handleNewCoreTemperature()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00536"></a>00536 {
<a name="l00537"></a>00537     <a class="code" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> calc;
<a name="l00538"></a>00538 
<a name="l00539"></a>00539     <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> interruptState = __save_interrupt();
<a name="l00540"></a>00540     __disable_interrupt();
<a name="l00541"></a>00541     calc = <a class="code" href="vadc_8c.html#07c6f60b9c283becc2c047613b3a934d" title="VTEMP input sample from the vadc ISR.">vtempMeasurement</a>;
<a name="l00542"></a>00542     __restore_interrupt(interruptState);
<a name="l00543"></a>00543     calc *= (<a class="code" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>)<a class="code" href="vadc_8c.html#8a6c3694b1912cc4077876b658cab7db" title="Internal temperature sensor coefficient.">vptatCoeff</a>*10; <span class="comment">// Times 10 to get result in 0.1Kelvin</span>
<a name="l00544"></a>00544     calc &gt;&gt;= <a class="code" href="vadc_8h.html#daea25c71e5980d34dfacd562e290a7f" title="Number of bit for scaling results (16384). See VADC in datasheets for formulas.">VADC_SCALE_BITS</a>;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546     <span class="keywordflow">return</span> (<a class="code" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a>)(calc);
<a name="l00547"></a>00547 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d643e5b97a0eb9cd93ae80e2527bbade"></a><!-- doxytag: member="vadc.c::VADC_ScanConfig" ref="d643e5b97a0eb9cd93ae80e2527bbade" args="(vadcIndex_t CellInputs, vadcIndex_t VadcInputs, vadcIndex_t vtempScan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VADC_ScanConfig           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a>&nbsp;</td>
          <td class="paramname"> <em>CellInputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a>&nbsp;</td>
          <td class="paramname"> <em>VadcInputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed">vadcIndex_t</a>&nbsp;</td>
          <td class="paramname"> <em>vtempScan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Select VADC channels to be scanned. 
<p>
Configuration of which VADC channel(s) to be sampled is stored in the file global variable <a class="el" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a>. Enums used from <a class="el" href="vadc_8h.html#5ed5da99ecfd6b14544e9fde0bbe28ed" title="Typedef used where number of cells is input to functions.">vadcIndex_t</a> .<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CellInputs</em>&nbsp;</td><td>Name of highest cell to be sampled. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>VadcInputs</em>&nbsp;</td><td>Name of Highest vadc input to be sampled. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vtempScan</em>&nbsp;</td><td>Scan internal temperature sensor if <a class="el" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714499726d93b81232e1e9a84c16e5355e77b">VTEMP</a>. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00108">108</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00089">CELL1</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL2</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL3</a>, <a class="el" href="vadc_8h-source.html#l00089">CELL4</a>, <a class="el" href="vadc_8h-source.html#l00089">VADC0</a>, <a class="el" href="vadc_8h-source.html#l00089">VADC1</a>, <a class="el" href="vadc_8c-source.html#l00090">vadcScanConfig</a>, and <a class="el" href="vadc_8h-source.html#l00089">VTEMP</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l01013">configureVADC()</a>, and <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00109"></a>00109 {
<a name="l00110"></a>00110     <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> = 0;
<a name="l00111"></a>00111     
<a name="l00112"></a>00112 <span class="preprocessor">#if CELL_INPUTS &gt;= 4</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( CellInputs == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714495dc31be69defc09d627e487ce6a56c1a">CELL4</a> ) {
<a name="l00114"></a>00114         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714495dc31be69defc09d627e487ce6a56c1a">CELL4</a>) | (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a>) | (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a>) | (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>);
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116 <span class="preprocessor">#endif</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span><span class="preprocessor">#if CELL_INPUTS &gt;= 3</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( CellInputs == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a> ) {
<a name="l00119"></a>00119         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714494ab35dc613899d959b4e063d736deb2d">CELL3</a>) | (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a>) | (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>);
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121 <span class="preprocessor">#endif</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span><span class="preprocessor">#if CELL_INPUTS &gt;= 2</span>
<a name="l00123"></a>00123 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( CellInputs == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a> ) {
<a name="l00124"></a>00124         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144983bc57407aa6f82e37d495ff9d28ed81">CELL2</a>) | (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>);
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126 <span class="preprocessor">#endif</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( CellInputs == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a> ) {
<a name="l00128"></a>00128         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>);
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130     <span class="keywordflow">if</span> (VadcInputs == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144934a20579d8ecc17304f9c59844e33fd4">VADC1</a>) {
<a name="l00131"></a>00131         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac67144934a20579d8ecc17304f9c59844e33fd4">VADC1</a>)| (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>);
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133     <span class="keywordflow">if</span> (VadcInputs == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>) {
<a name="l00134"></a>00134         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>);
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136     <span class="keywordflow">if</span> (vtempScan == <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714499726d93b81232e1e9a84c16e5355e77b">VTEMP</a>) {
<a name="l00137"></a>00137         <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> |= (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714499726d93b81232e1e9a84c16e5355e77b">VTEMP</a>);
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a36cbd40622b622424c4d6af8fb2bef3"></a><!-- doxytag: member="vadc.c::VADC_ScanState" ref="a36cbd40622b622424c4d6af8fb2bef3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="vadc_8h.html#837efbd444e46d60a46b9762d7fb01c8">vadcState_t</a> VADC_ScanState           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check VADC scan status. 
<p>
The internal <a class="el" href="structVADC__Status.html">VADC_Status</a> struct<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>vadcStatus.state </dd></dl>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00307">307</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00078">VADC_Status::state</a>, and <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00812">handleNewCellVoltage()</a>, and <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00308"></a>00308 {
<a name="l00309"></a>00309     <span class="keywordflow">return</span> <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a>;
<a name="l00310"></a>00310 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ed438796e781f411ac4cfbd3a89b2429"></a><!-- doxytag: member="vadc.c::VADC_StartScan" ref="ed438796e781f411ac4cfbd3a89b2429" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698">err_t</a> VADC_StartScan           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start a scan of all VADC channels. 
<p>
VADC is set up and interrupts enabled. The first vadc channel to be sampled is selected according to <a class="el" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a>. The interrupt routine VADC_ISR does the actual vadc measurements. Global interrupts need to be enabled in main for the vadc interrupt routine to be run.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698c7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a> or <a class="el" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698a5571864412c8275a2e18a931fddcaa6">FAILURE</a> </dd></dl>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00175">175</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8h-source.html#l00089">CELL1</a>, <a class="el" href="error_8h-source.html#l00005">FAILURE</a>, <a class="el" href="vadc_8h-source.html#l00078">VADC_Status::state</a>, <a class="el" href="error_8h-source.html#l00005">SUCCESS</a>, <a class="el" href="vadc_8h-source.html#l00089">VADC0</a>, <a class="el" href="vadc_8c-source.html#l00150">VADC_ClearReadyFlags()</a>, <a class="el" href="vadc_8h-source.html#l00075">VADC_RUNNING</a>, <a class="el" href="vadc_8c-source.html#l00090">vadcScanConfig</a>, <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>, and <a class="el" href="vadc_8h-source.html#l00089">VTEMP</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00176"></a>00176 {
<a name="l00177"></a>00177     <a class="code" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698">err_t</a> status = <a class="code" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698c7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;
<a name="l00178"></a>00178     
<a name="l00179"></a>00179     <span class="comment">// start set up for first channel.</span>
<a name="l00180"></a>00180     <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714499726d93b81232e1e9a84c16e5355e77b">VTEMP</a>) ) {
<a name="l00181"></a>00181         VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714499726d93b81232e1e9a84c16e5355e77b">VTEMP</a>;
<a name="l00182"></a>00182     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>) ) {
<a name="l00183"></a>00183         VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac6714493a7e51ebd764fa9744a13488cd41a39e">VADC0</a>;
<a name="l00184"></a>00184     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79" title="VADC channel sampling config.">vadcScanConfig</a> &amp; (1 &lt;&lt; <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>) ) {
<a name="l00185"></a>00185         VADMUX = <a class="code" href="vadc_8h.html#c0b5c20a479d5ecd6b20b99dac671449b08613e4845ef2a5d657b8562c394673">CELL1</a>;
<a name="l00186"></a>00186     } <span class="keywordflow">else</span> {
<a name="l00187"></a>00187         status = <a class="code" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698a5571864412c8275a2e18a931fddcaa6">FAILURE</a>;
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189     <span class="keywordflow">if</span> (status == <a class="code" href="error_8h.html#5edd7aad54ac059bf561cf2f92017698c7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>) {
<a name="l00190"></a>00190         VADCSR = (1&lt;&lt;VADCCIF);     <span class="comment">//clear any pending interrupt</span>
<a name="l00191"></a>00191         VADCSR = (1&lt;&lt;VADEN) | (1&lt;&lt;VADSC) | (1&lt;&lt;VADCCIE);  <span class="comment">//Start the first conversion &amp; enable the vadc.</span>
<a name="l00192"></a>00192         <span class="comment">// Global interrupts need to be enabled in main for the vadc interrupt routine to be run.</span>
<a name="l00193"></a>00193         <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#6da4298a09c9753e1921eff089130351">state</a> = <a class="code" href="vadc_8h.html#174ac16661827ae97404ee065e8ecf5e5fc0704fc5cb466b1d72ce9c2a2b5548">VADC_RUNNING</a>;
<a name="l00194"></a>00194         <a class="code" href="vadc_8c.html#2394682eaa80101d85ce5d023beeaf5d" title="Clear the ready flags.">VADC_ClearReadyFlags</a>();
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196     <span class="keywordflow">return</span> status;
<a name="l00197"></a>00197 }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="vadc_8c_ed438796e781f411ac4cfbd3a89b2429_cgraph.gif" border="0" usemap="#vadc_8c_ed438796e781f411ac4cfbd3a89b2429_cgraph_map" alt=""></center>
<map name="vadc_8c_ed438796e781f411ac4cfbd3a89b2429_cgraph_map">
<area shape="rect" href="vadc_8c.html#2394682eaa80101d85ce5d023beeaf5d" title="Clear the ready flags." alt="" coords="177,5,340,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0b978ff704a91cd39fc99bd6dbe2031d"></a><!-- doxytag: member="vadc.c::VADC_VTempReady" ref="0b978ff704a91cd39fc99bd6dbe2031d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VADC_VTempReady           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if new core temperature reading s available. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00326">326</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>References <a class="el" href="vadc_8c-source.html#l00075">vadcStatus</a>, and <a class="el" href="vadc_8h-source.html#l00083">VADC_Status::vtempReady</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00187">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00327"></a>00327 {
<a name="l00328"></a>00328     <a class="code" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> interruptState = __save_interrupt();
<a name="l00329"></a>00329     __disable_interrupt();
<a name="l00330"></a>00330     
<a name="l00331"></a>00331     <span class="keywordtype">bool</span> flagState = <a class="code" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>.<a class="code" href="structVADC__Status.html#8422bc7922ffdd16e97595cd643a8149">vtempReady</a>;
<a name="l00332"></a>00332     
<a name="l00333"></a>00333     __restore_interrupt( interruptState );
<a name="l00334"></a>00334     
<a name="l00335"></a>00335     <span class="keywordflow">return</span> flagState;
<a name="l00336"></a>00336 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="15539802be0709baff2a07339f42ce6f"></a><!-- doxytag: member="vadc.c::cellGain" ref="15539802be0709baff2a07339f42ce6f" args="[BATTPARAM_CELLS_IN_SERIES]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="vadc_8c.html#15539802be0709baff2a07339f42ce6f">cellGain</a>[BATTPARAM_CELLS_IN_SERIES]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gain coefficients for Cells. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00061">61</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00405">VADC_InitializeVadcCoefficients()</a>, and <a class="el" href="vadc_8c-source.html#l00450">VADC_readCellVoltage()</a>.</p>

</div>
</div><p>
<a class="anchor" name="581662a132acab8e3ce549d018874d03"></a><!-- doxytag: member="vadc.c::cellMeasurement" ref="581662a132acab8e3ce549d018874d03" args="[BATTPARAM_CELLS_IN_SERIES]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="vadc_8c.html#581662a132acab8e3ce549d018874d03">cellMeasurement</a>[BATTPARAM_CELLS_IN_SERIES]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Cell input samples from the vadc ISR. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00063">63</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00210">VADC_ISR()</a>, and <a class="el" href="vadc_8c-source.html#l00450">VADC_readCellVoltage()</a>.</p>

</div>
</div><p>
<a class="anchor" name="db97aeed8bd0d11fb210e1ae86f65bbd"></a><!-- doxytag: member="vadc.c::cellOffset" ref="db97aeed8bd0d11fb210e1ae86f65bbd" args="[BATTPARAM_CELLS_IN_SERIES]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#ef44329758059c91c76d334e8fc09700">int8_t</a> <a class="el" href="vadc_8c.html#db97aeed8bd0d11fb210e1ae86f65bbd">cellOffset</a>[BATTPARAM_CELLS_IN_SERIES]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Offset for cells. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00062">62</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00405">VADC_InitializeVadcCoefficients()</a>, and <a class="el" href="vadc_8c-source.html#l00450">VADC_readCellVoltage()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c829a83ff99a490b333ec98302419850"></a><!-- doxytag: member="vadc.c::cellVoltage" ref="c829a83ff99a490b333ec98302419850" args="[BATTPARAM_CELLS_IN_SERIES]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="vadc_8c.html#c829a83ff99a490b333ec98302419850">cellVoltage</a>[BATTPARAM_CELLS_IN_SERIES]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Cell input voltage. Set to 0xFFFF if not calculated from latest cellMeasurement. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00064">64</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00210">VADC_ISR()</a>, and <a class="el" href="vadc_8c-source.html#l00450">VADC_readCellVoltage()</a>.</p>

</div>
</div><p>
<a class="anchor" name="658c51041b7ceacab85ac70e4216ca79"></a><!-- doxytag: member="vadc.c::vadcScanConfig" ref="658c51041b7ceacab85ac70e4216ca79" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#ba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="el" href="vadc_8c.html#658c51041b7ceacab85ac70e4216ca79">vadcScanConfig</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
VADC channel sampling config. 
<p>
Configuration of which VADC channels to be scanned. A bit is used for each input according to the MUX setting, e.g. (1 &lt;&lt; CELL1) for cell1 measurements.<p>
<a class="el" href="vadc_8c.html#d643e5b97a0eb9cd93ae80e2527bbade" title="Select VADC channels to be scanned.">VADC_ScanConfig()</a> configures this variable. It is used by <a class="el" href="vadc_8c.html#ed438796e781f411ac4cfbd3a89b2429" title="Start a scan of all VADC channels.">VADC_StartScan()</a> to select first input, while <a class="el" href="vadc_8c.html#e09008d7d72d205a8464354f571fe14c" title="Interrupt Service Function to measure VADC values.">VADC_ISR()</a> then scans the channels selected in a fixed order but only those selected in vadcScanConfig.<p>
The highest MUX setting that can be contained in this 8 bit variable is 7, so it needs to be expanded for devices with more vadc inputs than ATmega16HVA. CELL1 is assumed to always be measured. 
<p>Definition at line <a class="el" href="vadc_8c-source.html#l00090">90</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00144">VADC_GetScanConfig()</a>, <a class="el" href="vadc_8c-source.html#l00210">VADC_ISR()</a>, <a class="el" href="vadc_8c-source.html#l00108">VADC_ScanConfig()</a>, and <a class="el" href="vadc_8c-source.html#l00175">VADC_StartScan()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a5a74419e5d5b12452f36b8c6b029d1d"></a><!-- doxytag: member="vadc.c::vadcStatus" ref="a5a74419e5d5b12452f36b8c6b029d1d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structVADC__Status.html">VADC_Status</a> <a class="el" href="vadc_8c.html#a5a74419e5d5b12452f36b8c6b029d1d">vadcStatus</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00075">75</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00339">VADC_Cell1VoltageReady()</a>, <a class="el" href="vadc_8c-source.html#l00313">VADC_CellTempReady()</a>, <a class="el" href="vadc_8c-source.html#l00150">VADC_ClearReadyFlags()</a>, <a class="el" href="vadc_8c-source.html#l00210">VADC_ISR()</a>, <a class="el" href="vadc_8c-source.html#l00307">VADC_ScanState()</a>, <a class="el" href="vadc_8c-source.html#l00175">VADC_StartScan()</a>, and <a class="el" href="vadc_8c-source.html#l00326">VADC_VTempReady()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8a6c3694b1912cc4077876b658cab7db"></a><!-- doxytag: member="vadc.c::vptatCoeff" ref="8a6c3694b1912cc4077876b658cab7db" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="vadc_8c.html#8a6c3694b1912cc4077876b658cab7db">vptatCoeff</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal temperature sensor coefficient. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00072">72</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00405">VADC_InitializeVadcCoefficients()</a>, and <a class="el" href="vadc_8c-source.html#l00535">VADC_readSystemTemperature()</a>.</p>

</div>
</div><p>
<a class="anchor" name="07c6f60b9c283becc2c047613b3a934d"></a><!-- doxytag: member="vadc.c::vtempMeasurement" ref="07c6f60b9c283becc2c047613b3a934d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="vadc_8c.html#07c6f60b9c283becc2c047613b3a934d">vtempMeasurement</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
VTEMP input sample from the vadc ISR. 
<p>

<p>Definition at line <a class="el" href="vadc_8c-source.html#l00073">73</a> of file <a class="el" href="vadc_8c-source.html">vadc.c</a>.</p>

<p>Referenced by <a class="el" href="vadc_8c-source.html#l00210">VADC_ISR()</a>, and <a class="el" href="vadc_8c-source.html#l00535">VADC_readSystemTemperature()</a>.</p>

</div>
</div><p>
</div>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>@DOC_TITLE@</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="6" height="1" background="blue.gif"></td>
  </tr>

  <tr>
    <td colspan="6">
    <address style="align: right;"><small>
Generated on Wed Aug 4 11:00:42 2010 for AVR474 Firmware User's Guide for SB202 by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.5.6</small></address>
    </td>
  </tr>

</table>
